<!DOCTYPE html>
<html>

<head>
  <title>3/4 Inch Handwriting Worksheet Generator</title>
  <link rel="apple-touch-icon" sizes="57x57" href="icons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="icons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="icons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="icons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="icons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="icons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="icons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="icons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="icons/favicon-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="icons/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="icons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="icons/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="icons/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#00a300">
  <meta name="msapplication-TileImage" content="/icons/mstile-144x144.png">
  <!-- Import fonts-->
  <link rel="stylesheet" href="css/fonts.css" type="text/css" />
  <!-- Import jsPDF (to convert Canvas to PDF), plus image plugin-->
  <script src="scripts/jspdf.min.js" type="text/javascript"></script>
  <script src="scripts/jspdf.plugin.addimage.js" type="text/javascript"></script>
  <!-- Import custom Drawing functions -->
  <script type="text/javascript">
    function clearForm() {
      document.getElementById("title").value = "";
      for (var i = 1; i < 9; i++) {
        document.getElementById("R" + i).value = "";
      }

      refresh(document.getElementById('canvas'));
    }

    /*function refresh(canvas)
    {
    var context = canvas.getContext('2d');
    context.fillRect ( 0, 0, 816, 1056);
    var imageObj = new Image();
      imageObj.onload = function() {
        context.drawImage(imageObj, 0, 0);
      };
      imageObj.src = './3:4paper.png';
    }*/

    function publish(canvas) {
      var pdf = new jsPDF();
      pdf.addImage(canvas, 'JPEG', 0, 0);
      window.open(pdf.output('bloburl'));
    }


    function draw(canvas) {
      refresh(canvas);

      var ctx = canvas.getContext("2d");
      var startPos = 50;
      ctx.fillStyle = '#000000';

      var style = document.getElementById("style").value;
      var title = document.getElementById("title").value;
      var r1 = document.getElementById("R1").value;
      var r2 = document.getElementById("R2").value;
      var r3 = document.getElementById("R3").value;
      var r4 = document.getElementById("R4").value;
      var r5 = document.getElementById("R5").value;
      var r6 = document.getElementById("R6").value;
      var r7 = document.getElementById("R7").value;
      var r8 = document.getElementById("R8").value;

      ctx.font = "40px Arial";
      ctx.textAlign = "center";
      ctx.fillText(title, 408, 55);
      ctx.textAlign = "left";

      if (style == "print") {
        ctx.font = "100px print_dashed";


        ctx.fillText(r1, startPos, 200);
        ctx.fillText(r2, startPos, 308);
        ctx.fillText(r3, startPos, 416);
        ctx.fillText(r4, startPos, 524);
        ctx.fillText(r5, startPos, 632);
        ctx.fillText(r6, startPos, 740);
        ctx.fillText(r7, startPos, 848);
        ctx.fillText(r8, startPos, 956);
      }
      else {
        ctx.font = "120px cursive_dashed"

        ctx.fillText(r1, startPos, 205);
        ctx.fillText(r2, startPos, 313);
        ctx.fillText(r3, startPos, 421);
        ctx.fillText(r4, startPos, 529);
        ctx.fillText(r5, startPos, 637);
        ctx.fillText(r6, startPos, 745);
        ctx.fillText(r7, startPos, 853);
        ctx.fillText(r8, startPos, 961);
      }
    }

    /* This dashedLine function was written by Jignesh Variya and posted on StackOverflow */
    CanvasRenderingContext2D.prototype.dashedLine = function (x1, y1, x2, y2, dashLen) {
      if (dashLen == undefined) dashLen = 2;
      this.moveTo(x1, y1);

      var dX = x2 - x1;
      var dY = y2 - y1;
      var dashes = Math.floor(Math.sqrt(dX * dX + dY * dY) / dashLen);
      var dashX = dX / dashes;
      var dashY = dY / dashes;

      var q = 0;
      while (q++ < dashes) {
        x1 += dashX;
        y1 += dashY;
        this[q % 2 == 0 ? 'moveTo' : 'lineTo'](x1, y1);
      }
      this[q % 2 == 0 ? 'moveTo' : 'lineTo'](x2, y2);
    };


    function refresh(canvas) {
      var ctx = canvas.getContext('2d');
      var startPos = 45;

      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, 0, 817, 1066);

      ctx.strokeStyle = '#000000';

      ctx.beginPath();

      ctx.moveTo(startPos, 130);
      ctx.lineTo(startPos + 726, 130);
      ctx.dashedLine(startPos, 166, startPos + 726, 166, 8);
      ctx.moveTo(startPos, 202);
      ctx.lineTo(startPos + 726, 202);

      ctx.moveTo(startPos, 240);
      ctx.lineTo(startPos + 726, 240);
      ctx.dashedLine(startPos, 274, startPos + 726, 274, 8);
      ctx.moveTo(startPos, 310);
      ctx.lineTo(startPos + 726, 310);

      ctx.moveTo(startPos, 347);
      ctx.lineTo(startPos + 726, 347);
      ctx.dashedLine(startPos, 383, startPos + 726, 383, 8);
      ctx.moveTo(startPos, 419);
      ctx.lineTo(startPos + 726, 419);

      ctx.moveTo(startPos, 454);
      ctx.lineTo(startPos + 726, 454);
      ctx.dashedLine(startPos, 490, startPos + 726, 490, 8);
      ctx.moveTo(startPos, 526);
      ctx.lineTo(startPos + 726, 526);

      ctx.moveTo(startPos, 561);
      ctx.lineTo(startPos + 726, 561);
      ctx.dashedLine(startPos, 597, startPos + 726, 597, 8);
      ctx.moveTo(startPos, 633);
      ctx.lineTo(startPos + 726, 633);

      ctx.moveTo(startPos, 669);
      ctx.lineTo(startPos + 726, 669);
      ctx.dashedLine(startPos, 705, startPos + 726, 705, 8);
      ctx.moveTo(startPos, 741);
      ctx.lineTo(startPos + 726, 741);

      ctx.moveTo(startPos, 777);
      ctx.lineTo(startPos + 726, 777);
      ctx.dashedLine(startPos, 813, startPos + 726, 813, 8);
      ctx.moveTo(startPos, 849);
      ctx.lineTo(startPos + 726, 849);

      ctx.moveTo(startPos, 885);
      ctx.lineTo(startPos + 726, 885);
      ctx.dashedLine(startPos, 921, startPos + 726, 921, 8);
      ctx.moveTo(startPos, 957);
      ctx.lineTo(startPos + 726, 957);

      ctx.stroke();
    }
  </script>
  <link rel="stylesheet" href="css/css.css" type="text/css" />
</head>

<body>
  <p class="print">Handwriting Worksheet Generator</p>
  <a class="return" href="index.html">Return to Size Select</a><br><br>
  <table>
    <tr>
      <td class="main"><label for="style">Style:</label></td>
      <td><select id="style">
          <option selected value="print">Print</option>
          <option value="cursive">Cursive</option>
        </select></td>
    </tr>
    <tr>
      <td class="main"><label for="title">Title:</label></td>
      <td><input type="text" id="title" size="20" /></td>
    </tr>
    <tr>
      <td class="main"><label for="R1">Row 1:</label></td>
      <td><input type="text" id="R1" maxlength="18" size="20" /></td>
    </tr>
    <tr>
      <td class="main"><label for="R2">Row 2:</label></td>
      <td><input type="text" id="R2" maxlength="18" size="20" /></td>
    </tr>
    <tr>
      <td class="main"><label for="R3">Row 3:</label></td>
      <td><input type="text" id="R3" maxlength="18" size="20" /></td>
    </tr>
    <tr>
      <td class="main"><label for="R4">Row 4:</label></td>
      <td><input type="text" id="R4" maxlength="18" size="20" /></td>
    </tr>
    <tr>
      <td class="main"><label for="R5">Row 5:</label></td>
      <td><input type="text" id="R5" maxlength="18" size="20" /></td>
    </tr>
    <tr>
      <td class="main"><label for="R6">Row 6:</label></td>
      <td><input type="text" id="R6" maxlength="18" size="20" /></td>
    </tr>
    <tr>
      <td class="main"><label for="R7">Row 7:</label></td>
      <td><input type="text" id="R7" maxlength="18" size="20" /></td>
    </tr>
    <tr>
      <td class="main"><label for="R8">Row 8:</label></td>
      <td><input type="text" id="R8" maxlength="18" size="20" /></td>
    </tr>
    <tr>
      <td><button type="button" onclick="draw(document.getElementById('canvas'));">Generate Preview</button></td>
      <td><button type="button" onclick="clearForm();">Clear Form</button>
        <button type="button" onclick="publish(document.getElementById('canvas'));">Generate PDF</button>
    </tr>
  </table>
  <p>Preview</p>
  <canvas id="canvas" width="816" height="1056">This browser is either out of date or does not support HTML5. Please
    upgrade your browser.</canvas>
  <script type="text/javascript">
    refresh(document.getElementById('canvas'));
  </script><noscript>JavaScript is required to run this. Please turn it on if it is off, or upgrade your
    browser.</noscript><br>

  <p class="cursive">Version 1&nbsp;.&nbsp;2&nbsp;.&nbsp;0<br> &copy; 2015 Ben Dunphy<br>This Project arose out of a
    homeshcooling mom's tapping into her son's programming skills.</p>
</body>

</html>